
Here we are interested in analysing the brain data from our paper. The first step is to upload the data:

```{r}
dat<-read.table("/home/unix/ssimmons/FivePrime/GithubCode/FivePrime/AnalysingBrain/data/Brain_Data.bed",header=T)
head(dat)
```

We can then import the code. Note that this code was used for Figure 6b and 6c to get the corresponding p-value.

```{r}
source("/ahg/regevdata/projects/FiveprimeRNA/seanken/GithubCode/FivePrime/AnalysingBrain/Pval.R")
```

We are then able to calculate the normalized change in 5' to 3' bias, the p-value, and standard deviation and errors. For example, if we want to compare the invitro neurons (H66) to the fetal frontal cortex data, we get:

```{r}
pv=getPval(dat,"H66","Fetal_Frontal")
print(pv)
```

This is testing if H66 is more 5' than fetal frontal cortex. Note the results are close, but not quite identical to those in the paper--this is due to the random downsampling step when calling peaks.

If we aren't interested in comparing 5' bias between samples but instead of comparing the number of TSS used per Gene, we would run:

```{r}
pv=getPval(dat,"H66","Fetal_Frontal",normed=F,scor_test="num")
print(pv)
```

This is testing the hypopthesis that H66 has less active TSS than the fetal frontal cortex.

